(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     36693,        765]
NotebookOptionsPosition[     36360,        750]
NotebookOutlinePosition[     36792,        767]
CellTagsIndexPosition[     36749,        764]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", "All", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"res", "=", 
    RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "overall", " ", "concentration", " ", "and", " ", "disc", " ", "mole", " ",
     "fraction"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xx", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "convert", " ", "to", " ", "overall", " ", "monomer", " ", "and", " ", 
    "disc", " ", "concentrations"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr0", "=", 
   RowBox[{"cc", "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", "xx"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rd0", "=", 
    RowBox[{"cc", "*", "xx"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"excluded", " ", "volume", " ", "rations"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qq", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zz", "=", "1"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "starting", " ", "values", " ", "for", " ", "nematic", " ", "order", " ", 
     "parameters", " ", "and", " ", "normalization", " ", "constant"}], ",", 
    " ", 
    RowBox[{"this", " ", "is", " ", "the", " ", "tricky", " ", "bit"}], ",", 
    " ", 
    RowBox[{
    "they", " ", "need", " ", "to", " ", "be", " ", "reasonably", " ", 
     "close", " ", "to", " ", "the", " ", "real", " ", "values", " ", "that", 
     " ", "are", " ", "a", " ", "priori", " ", "unknown"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sravs", "=", "0.8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sds", "=", 
   RowBox[{"-", "0.4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lambdas", "=", 
    RowBox[{"-", "3"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"cut", "-", 
     RowBox[{"off", " ", "for", " ", "polymerization", " ", "degree"}]}], ",",
     " ", 
    RowBox[{"note", ":", " ", 
     RowBox[{
     "this", " ", "value", " ", "should", " ", "be", " ", "large", " ", 
      "enough", " ", "to", " ", "make", " ", "sure", " ", "the", " ", 
      "polymer", " ", "distribution", " ", "remains", " ", "close", " ", "to",
       " ", "zero", " ", "at", " ", "llmax"}]}], ",", " ", 
    RowBox[{
    "if", " ", "not", " ", "llmax", " ", "should", " ", "be", " ", 
     "increased", " ", "which", " ", "slows", " ", "down", " ", "the", " ", 
     "computation"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"llmax", "=", "150"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"persistence", " ", "length"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lp", "=", "5"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"loop", " ", "over", " ", "temperature"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"eb", "=", "5"}], ",", 
    RowBox[{"eb", ">", "1"}], ",", 
    RowBox[{
     RowBox[{"eb", "=", 
      RowBox[{"eb", "-", "0.2"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"this", " ", "iteration", " ", "resolves", " ", "S_polymer"}], 
       ",", " ", 
       RowBox[{
       "S_disc", " ", "and", " ", "normalization", " ", "factor", " ", 
        "lambda"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"df", "=", "100"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"df", ">", "1"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"alignment", " ", "amplitudes"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ar", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"5", "/", "4"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rr0", "*", "srav"}], "-", 
            RowBox[{"2", "*", "qq", "*", "rd0", "*", "sds"}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ad", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"5", "/", "4"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"zz", "*", "rd0", "*", "sds"}], "-", 
            RowBox[{"2", "*", "qq", "*", "rr0", "*", "srav"}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "chi", " ", "parameter", " ", "for", " ", "weakly", " ", "flexible", 
          "  ", "rods"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"xi", "=", 
         RowBox[{"1", "+", 
          RowBox[{"Abs", "[", "ar", "]"}], "+", "lp", "-", 
          SqrtBox[
           RowBox[{"1", "+", 
            RowBox[{"2", "*", "lp"}], "+", 
            RowBox[{"2", "*", 
             RowBox[{"Abs", "[", "ar", "]"}], "*", "lp"}], "+", 
            SuperscriptBox["lp", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"effective", " ", "amplitude"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"arbar", "=", 
         RowBox[{"ar", "-", 
          RowBox[{
           RowBox[{"Sign", "[", "ar", "]"}], "*", "xi"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "polymer", " ", "length", " ", "distribution", " ", "with", " ", 
          "lambda", " ", "as", " ", "yet", " ", "unspecified"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"rl", "=", 
         RowBox[{"ll", "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"eb", "+", 
            RowBox[{"lambda", "*", "ll"}]}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"arbar", "*", "ll"}], "]"}], "*", 
          RowBox[{
           RowBox[{"DawsonF", "[", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"3", "*", "arbar", "*", "ll"}], ")"}], "/", "2"}]], 
            "]"}], "/", 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "*", "arbar", "*", "ll"}], ")"}], "/", 
             "2"}]]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"srl", "=", 
         RowBox[{
          FractionBox["1", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "-", 
            FractionBox["2", 
             RowBox[{"arbar", "*", "ll"}]], "+", 
            FractionBox[
             SqrtBox["6"], 
             RowBox[{
              SqrtBox[
               RowBox[{"arbar", "*", "ll"}]], " ", 
              RowBox[{"DawsonF", "[", 
               RowBox[{
                SqrtBox[
                 FractionBox["3", "2"]], " ", 
                SqrtBox[
                 RowBox[{"arbar", "*", "ll"}]]}], "]"}]}]]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"solv1", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lambda", ",", "srav"}], "}"}], "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{"rl", ",", 
                 RowBox[{"{", 
                  RowBox[{"ll", ",", "1", ",", "llmax"}], "}"}]}], "]"}], 
               "\[Equal]", "rr0"}], ",", 
              RowBox[{
               RowBox[{
                SuperscriptBox["rr0", 
                 RowBox[{"-", "1"}]], "*", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"srl", "*", "rl"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ll", ",", "1", ",", "llmax"}], "}"}]}], "]"}]}], "==",
                "srav"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"lambda", ",", "lambdas"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"srav", ",", "sravs"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"lambdan", "=", 
         RowBox[{"Re", "[", 
          RowBox[{"solv1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"sravn", "=", 
         RowBox[{"Re", "[", 
          RowBox[{"solv1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"adn", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"5", "/", "4"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"zz", "*", "rd0", "*", "sd"}], "-", 
            RowBox[{"2", "*", "qq", "*", "rr0", "*", "sravn"}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"solv2", "=", 
         RowBox[{
          RowBox[{"{", "sd", "}"}], "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"sd", "==", 
             RowBox[{
              FractionBox["1", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "-", 
                FractionBox["2", "adn"], "+", 
                FractionBox[
                 SqrtBox["6"], 
                 RowBox[{
                  SqrtBox["adn"], " ", 
                  RowBox[{"DawsonF", "[", 
                   RowBox[{
                    SqrtBox[
                    FractionBox["3", "2"]], " ", 
                    SqrtBox["adn"]}], "]"}]}]]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"sd", ",", "sds"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sdn", "=", 
         RowBox[{"Re", "[", 
          RowBox[{"solv2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"df", "=", 
         RowBox[{
          SuperscriptBox["10", "5"], "*", 
          RowBox[{"Max", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"sdn", "-", "sds"}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"sravn", "-", "sravs"}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"lambdan", "-", "lambdas"}], "]"}]}], "}"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "df", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"sds", "=", "sdn"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"lambdas", "=", "lambdan"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"sravs", "=", "sravn"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "lp", ",", "\"\<  \>\"", ",", "sravn", ",", "\"\<   \>\"", ",", "sdn", 
       ",", "\"\< \>\"", ",", "lambdan"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"final", " ", "parameter", " ", "values"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"arf", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"5", "/", "4"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rr0", "*", "sravn"}], "-", 
         RowBox[{"2", "*", "qq", "*", "rd0", "*", "sdn"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"xif", "=", 
      RowBox[{"1", "+", 
       RowBox[{"Abs", "[", "arf", "]"}], "+", "lp", "-", 
       SqrtBox[
        RowBox[{"1", "+", 
         RowBox[{"2", "*", "lp"}], "+", 
         RowBox[{"2", "*", 
          RowBox[{"Abs", "[", "arf", "]"}], "*", "lp"}], "+", 
         SuperscriptBox["lp", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"arfbar", "=", 
      RowBox[{"arf", "-", 
       RowBox[{
        RowBox[{"Sign", "[", "arf", "]"}], "*", "xif"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"final", " ", "polymer", " ", "length", " ", "distribution"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rlf", "=", 
      RowBox[{"ll", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{"eb", "+", 
         RowBox[{"lambdan", "*", "ll"}]}], "]"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{"arfbar", "*", "ll"}], "]"}], "*", 
       RowBox[{
        RowBox[{"DawsonF", "[", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "*", "arfbar", "*", "ll"}], ")"}], "/", "2"}]], 
         "]"}], "/", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", "*", "arfbar", "*", "ll"}], ")"}], "/", "2"}]]}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "write", " ", "polymer", " ", "distribution", " ", "to", " ", "file"}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"resp", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ii", "=", "1"}], ",", 
       RowBox[{"ii", "<", "llmax"}], ",", 
       RowBox[{
        RowBox[{"ii", "=", 
         RowBox[{"ii", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"resp", ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Re", "[", 
             RowBox[{"rlf", "/.", 
              RowBox[{"{", 
               RowBox[{"ll", "\[Rule]", "ii"}], "}"}]}], "]"}]}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{"\"\<~/dis.dat\>\"", ",", "resp"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
        "compute", " ", "maximum", " ", "probability", " ", "for", " ", 
         "polymer", " ", "length", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "listrlf"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{"rlf", ",", 
          RowBox[{"{", 
           RowBox[{"ll", ",", "1", ",", "llmax"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"maxprob", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"listrlf", ",", 
            RowBox[{"Max", "[", "listrlf", "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "maxprob", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "*)"}], "\n", 
     RowBox[{"srlf", "=", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", 
         FractionBox["2", 
          RowBox[{"arfbar", "*", "ll"}]], "+", 
         FractionBox[
          SqrtBox["6"], 
          RowBox[{
           SqrtBox[
            RowBox[{"arfbar", "*", "ll"}]], " ", 
           RowBox[{"DawsonF", "[", 
            RowBox[{
             SqrtBox[
              FractionBox["3", "2"]], " ", 
             SqrtBox[
              RowBox[{"arfbar", "*", "ll"}]]}], "]"}]}]]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"m1", "=", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{"rlf", ",", 
          RowBox[{"{", 
           RowBox[{"ll", ",", "1", ",", "llmax"}], "}"}]}], "]"}], "/", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"rlf", "*", 
           SuperscriptBox["ll", 
            RowBox[{"-", "1"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"ll", ",", "1", ",", "llmax"}], "}"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"m2", "=", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"rlf", "*", "ll"}], ",", 
          RowBox[{"{", 
           RowBox[{"ll", ",", "1", ",", "llmax"}], "}"}]}], "]"}], "/", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"rlf", "*", 
           SuperscriptBox["ll", 
            RowBox[{"-", "1"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"ll", ",", "1", ",", "llmax"}], "}"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"var", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m2", "-", 
           SuperscriptBox["m1", "2"]}], ")"}], "/", 
         SuperscriptBox["m1", "2"]}], ")"}], 
       RowBox[{"1", "/", "2"}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "number", " ", "density", " ", "averaged", " ", "nematic", " ", "order",
        " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"sw", "=", 
      RowBox[{"Re", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"srlf", "*", "rlf", "*", 
           SuperscriptBox["ll", 
            RowBox[{"-", "1"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"ll", ",", "1", ",", "llmax"}], "}"}]}], "]"}], "/", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"rlf", "*", 
           SuperscriptBox["ll", 
            RowBox[{"-", "1"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"ll", ",", "1", ",", "llmax"}], "}"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "append", " ", "various", " ", "stuff", " ", "we", " ", "want", " ", 
       "to", " ", "measure", " ", "to", " ", "list", " ", "\"\<res\>\""}], 
      " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"res", ",", 
       RowBox[{"{", 
        RowBox[{
        "eb", ",", "m1", ",", "var", ",", "sravn", ",", "sdn", ",", "sw", ",",
          "maxprob"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"write", " ", "to", " ", "file"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<~/res.dat\>\"", ",", "res"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.780034246713632*^9, 3.7800343465266953`*^9}, {
   3.780035229911902*^9, 3.780035314342785*^9}, {3.780035456600432*^9, 
   3.7800355148388166`*^9}, {3.780035563663496*^9, 3.780035565359645*^9}, {
   3.7800355980888557`*^9, 3.780035731646744*^9}, {3.7800361182885237`*^9, 
   3.780036142430812*^9}, {3.780036220799374*^9, 3.7800363439587584`*^9}, {
   3.780036638263053*^9, 3.780036687654917*^9}, {3.780036895768427*^9, 
   3.7800368969746313`*^9}, {3.7800369731279287`*^9, 3.780037058614709*^9}, {
   3.780037233736782*^9, 3.780037242110607*^9}, {3.780037320599556*^9, 
   3.7800374953348427`*^9}, {3.780037795177178*^9, 3.780037799175227*^9}, {
   3.7800378438392572`*^9, 3.7800378440154552`*^9}, {3.7800382895357313`*^9, 
   3.7800383993107777`*^9}, {3.78004406846472*^9, 3.780044071334715*^9}, {
   3.7800441786955442`*^9, 3.780044180446805*^9}, {3.780044216798637*^9, 
   3.78004431638654*^9}, {3.78004441307104*^9, 3.780044428422997*^9}, {
   3.780044509873157*^9, 3.7800445153350763`*^9}, {3.780044569863151*^9, 
   3.780044571486966*^9}, {3.780044633192684*^9, 3.7800446556710987`*^9}, {
   3.780045474385859*^9, 3.780045475535898*^9}, {3.7800460053923483`*^9, 
   3.7800460062709846`*^9}, {3.780047435968083*^9, 3.780047438878829*^9}, {
   3.780048479112074*^9, 3.7800484799670877`*^9}, {3.7800489403031073`*^9, 
   3.780049034743408*^9}, {3.780049078567721*^9, 3.780049159206978*^9}, {
   3.780049569417376*^9, 3.780049578918909*^9}, {3.7800496099589567`*^9, 
   3.780049629894836*^9}, {3.780052165806767*^9, 3.780052180119075*^9}, {
   3.78005239219932*^9, 3.780052430366789*^9}, {3.780052745078925*^9, 
   3.780052747847002*^9}, {3.7800528545603437`*^9, 3.780052855431625*^9}, {
   3.780122748582861*^9, 3.780122754069539*^9}, {3.7801229040368233`*^9, 
   3.780122930340805*^9}, {3.7801229624210873`*^9, 3.780122999573161*^9}, {
   3.78012304174128*^9, 3.780123075029112*^9}, {3.780123711398264*^9, 
   3.780123725133059*^9}, 3.780136567647622*^9, {3.780136642575737*^9, 
   3.780136723838635*^9}, {3.7801367717809467`*^9, 3.780136843525001*^9}, {
   3.780136873901991*^9, 3.7801368904926987`*^9}, {3.780137762621814*^9, 
   3.780137778308886*^9}, 3.780139856526112*^9, 3.780139933412855*^9, {
   3.780140087925028*^9, 3.780140125324753*^9}, {3.78014021758891*^9, 
   3.7801402687329597`*^9}, {3.7801403977824297`*^9, 
   3.7801404022930403`*^9}, {3.7801405019099913`*^9, 3.780140507761791*^9}, 
   3.780212023410801*^9, {3.780212054256362*^9, 3.780212139594062*^9}, {
   3.7802124239141073`*^9, 3.780212426642366*^9}, {3.780214857172249*^9, 
   3.780214912810329*^9}, {3.780214978363571*^9, 3.780215011290346*^9}, {
   3.780215053378251*^9, 3.780215149049221*^9}, {3.780215260275136*^9, 
   3.780215334129374*^9}, {3.780215395124818*^9, 3.780215427457077*^9}, {
   3.780215459581349*^9, 3.780215473600854*^9}, {3.780215578948354*^9, 
   3.780215662290125*^9}, {3.78021572347722*^9, 3.7802158132432137`*^9}, {
   3.780215860762508*^9, 3.780215862234519*^9}, 3.7802161357633047`*^9, {
   3.7802162336502666`*^9, 3.780216252793997*^9}, {3.780216371283351*^9, 
   3.780216371505713*^9}, {3.780216402299911*^9, 3.780216421522361*^9}, {
   3.780216453556004*^9, 3.780216470290229*^9}, {3.7802166476684923`*^9, 
   3.780216648955021*^9}, {3.780216695011696*^9, 3.7802167053156433`*^9}, {
   3.780216761178261*^9, 3.7802167695390863`*^9}, {3.780216918261693*^9, 
   3.7802171134949017`*^9}, {3.7802175640505466`*^9, 3.78021765398553*^9}, {
   3.780217725170726*^9, 3.780217807642192*^9}, {3.780217842050268*^9, 
   3.780217981942987*^9}, {3.7802180552971373`*^9, 3.7802181612024403`*^9}, {
   3.780218218403358*^9, 3.780218257257936*^9}, {3.780218293996393*^9, 
   3.7802183246110086`*^9}, {3.780218355610889*^9, 3.780218423835672*^9}, {
   3.7802185085549173`*^9, 3.78021853407406*^9}, {3.7802185657884293`*^9, 
   3.780218566948017*^9}, {3.780218598082924*^9, 3.780218606954947*^9}, {
   3.780218819796466*^9, 3.780218882676033*^9}, {3.780218924052253*^9, 
   3.7802189341717253`*^9}, {3.780218991778778*^9, 3.780219022971292*^9}, {
   3.7802191431885977`*^9, 3.780219153979659*^9}, {3.7802193041886883`*^9, 
   3.780219304340663*^9}, 3.7802193384841757`*^9, 3.780219414749691*^9, {
   3.780224218077767*^9, 3.780224257357901*^9}, {3.780224444341289*^9, 
   3.780224450253048*^9}, {3.780224481677271*^9, 3.78022450006911*^9}, {
   3.7802251319094343`*^9, 3.7802252071652393`*^9}, {3.780225346678894*^9, 
   3.7802254154300127`*^9}, {3.780225473469576*^9, 3.7802254750055637`*^9}, {
   3.780225520469983*^9, 3.780225529308971*^9}, 3.78022556664583*^9, {
   3.780225620813567*^9, 3.780225652933071*^9}, {3.7802256839980927`*^9, 
   3.780225724397977*^9}, {3.780226231918174*^9, 3.780226256725246*^9}, {
   3.780394465596756*^9, 3.780394532767948*^9}, {3.780394675048332*^9, 
   3.780394679199522*^9}, {3.7803947182707157`*^9, 3.7803947212456284`*^9}, {
   3.780394814205514*^9, 3.7803948237097483`*^9}, {3.7803949033626966`*^9, 
   3.780394921810239*^9}, {3.7803949610834217`*^9, 3.780395027400206*^9}, {
   3.780395177315785*^9, 3.7803952645391483`*^9}, {3.780395301409136*^9, 
   3.780395345952132*^9}, {3.780395413379133*^9, 3.780395416427416*^9}, {
   3.780395531562827*^9, 3.7803956237639008`*^9}, {3.780395933334443*^9, 
   3.78039598652141*^9}, {3.78040109145935*^9, 3.7804010963034286`*^9}, {
   3.780401217631858*^9, 3.780401217817686*^9}, {3.780401357279416*^9, 
   3.780401360499517*^9}, {3.780401450369858*^9, 3.780401562803115*^9}, {
   3.780401634536623*^9, 3.780401644577057*^9}, {3.7804017561495953`*^9, 
   3.780401760603713*^9}, {3.780401794887937*^9, 3.7804018268637667`*^9}, {
   3.780401957300531*^9, 3.780401959758554*^9}, {3.780402020333062*^9, 
   3.780402038909121*^9}, 3.780402068984661*^9, {3.7804021000861607`*^9, 
   3.7804021003269377`*^9}, {3.780402138157632*^9, 3.780402166514612*^9}, {
   3.780402205502121*^9, 3.780402215532868*^9}, {3.780402262753366*^9, 
   3.780402275301051*^9}, {3.7804124184252996`*^9, 3.7804124197789307`*^9}, {
   3.7804125049730587`*^9, 3.780412540451145*^9}, {3.780412582756505*^9, 
   3.780412583495357*^9}, {3.7804126807234173`*^9, 3.7804126808856688`*^9}, {
   3.7804127774192333`*^9, 3.780412777598548*^9}, {3.780413081210018*^9, 
   3.780413081399869*^9}, {3.780413170826929*^9, 3.780413227397706*^9}, {
   3.780413259778515*^9, 3.780413259956243*^9}, {3.780413324186705*^9, 
   3.780413348921062*^9}, {3.780413415967723*^9, 3.780413445810267*^9}, {
   3.780917967119987*^9, 3.780917998390622*^9}, {3.780918042945277*^9, 
   3.7809180504077578`*^9}, {3.780918284970283*^9, 3.780918361425517*^9}, {
   3.780918418366149*^9, 3.780918478637034*^9}, 3.780918571646112*^9, {
   3.78091860425397*^9, 3.780918630479288*^9}, {3.7809188291283617`*^9, 
   3.780918907163006*^9}, {3.780919077245099*^9, 3.780919088379319*^9}, 
   3.780919146124364*^9, {3.780994925563711*^9, 3.780994941457376*^9}, {
   3.780994974775209*^9, 3.78099497511633*^9}, {3.780995013842757*^9, 
   3.7809950163413887`*^9}, 3.780995103724885*^9, {3.780995171361405*^9, 
   3.780995177534308*^9}, {3.780995248592752*^9, 3.780995254041774*^9}, {
   3.780995474867589*^9, 3.780995488577648*^9}, {3.780998060783208*^9, 
   3.780998072315423*^9}, {3.780998152616387*^9, 3.780998184034274*^9}, {
   3.780998308795136*^9, 3.78099832703454*^9}, {3.780998502845441*^9, 
   3.7809985030236273`*^9}, {3.780998656382636*^9, 3.780998666244997*^9}, {
   3.7809996723100557`*^9, 3.780999690406136*^9}, {3.780999816653751*^9, 
   3.780999848669153*^9}, {3.7809998975391903`*^9, 3.780999967485778*^9}, {
   3.78100014425467*^9, 3.78100016137899*^9}, {3.781000209562419*^9, 
   3.781000211039904*^9}, {3.781000305204123*^9, 3.781000308522832*^9}, {
   3.7810011762570257`*^9, 3.7810011814698763`*^9}, 3.781002154927178*^9, {
   3.781002322845121*^9, 3.781002474761284*^9}, {3.781002785543405*^9, 
   3.78100279769734*^9}, {3.781002854187248*^9, 3.781002854727788*^9}, {
   3.781003151487467*^9, 3.781003179641513*^9}, {3.781003221574011*^9, 
   3.7810033247610817`*^9}, {3.781003410533287*^9, 3.781003468380102*^9}, 
   3.781003538429435*^9, 3.781003626260469*^9, {3.781003665241734*^9, 
   3.781003671298308*^9}, 3.781003701366611*^9, {3.7810037974157352`*^9, 
   3.7810038295885477`*^9}, {3.781003908259809*^9, 3.7810039090527363`*^9}, {
   3.7810039626213503`*^9, 3.781003981167697*^9}, {3.781005080566475*^9, 
   3.781005097678625*^9}, {3.7810052354084787`*^9, 3.7810052356445103`*^9}, {
   3.7810054595437937`*^9, 3.781005470337427*^9}, {3.781005795615478*^9, 
   3.78100580042063*^9}, {3.78100601974135*^9, 3.7810060199137077`*^9}, {
   3.782558586136261*^9, 3.782558622255766*^9}, {3.7825586838627987`*^9, 
   3.782558873043331*^9}, {3.78256042771922*^9, 3.782560486934263*^9}, {
   3.782580565630145*^9, 3.782580604981801*^9}, {3.782580646142994*^9, 
   3.782580739017145*^9}, {3.782580874668017*^9, 3.78258092159024*^9}, 
   3.782581209643033*^9, 3.78258125866717*^9, {3.782581827704143*^9, 
   3.7825818283443813`*^9}, 3.782581897570734*^9, {3.7826452464691887`*^9, 
   3.782645246647601*^9}, {3.782645397325858*^9, 3.7826455217606087`*^9}, {
   3.782645713841318*^9, 3.782645745546791*^9}, 3.782645810810689*^9, {
   3.782646183990487*^9, 3.7826463089870043`*^9}, {3.7826464578391447`*^9, 
   3.782646463523828*^9}, {3.7826466878387127`*^9, 3.782646691255087*^9}, 
   3.782647008076778*^9, {3.782647097937933*^9, 3.7826471159813747`*^9}, {
   3.782647180353297*^9, 3.782647183848536*^9}, 3.782647297731104*^9, 
   3.782647367027699*^9, {3.782647551396307*^9, 3.782647662996379*^9}, {
   3.782647768674515*^9, 3.7826477845443573`*^9}, {3.782647856535233*^9, 
   3.782647865366783*^9}, {3.782647937394639*^9, 3.782647950891563*^9}, {
   3.782649229958152*^9, 3.782649232075891*^9}, {3.782649272683481*^9, 
   3.782649294758533*^9}, 3.7826494409197693`*^9, {3.782649676046241*^9, 
   3.7826496767398157`*^9}, 3.782649823518993*^9, {3.7826499333904543`*^9, 
   3.782650009028809*^9}, 3.782650052376861*^9, {3.782650115376774*^9, 
   3.782650136556994*^9}, {3.782650182222033*^9, 3.782650186267048*^9}, 
   3.7826502501987534`*^9, {3.78265028079557*^9, 3.78265028127787*^9}, {
   3.7826503172288103`*^9, 3.782650323297224*^9}, {3.782650359028542*^9, 
   3.782650359187394*^9}, {3.782650415724497*^9, 3.7826505214781647`*^9}, {
   3.782650617936789*^9, 3.7826506228070803`*^9}, {3.782650739506448*^9, 
   3.782650739718643*^9}, {3.782650827575995*^9, 3.782650908566614*^9}, {
   3.782651147964324*^9, 3.782651151864746*^9}, {3.782651387382431*^9, 
   3.782651441868771*^9}, {3.7826514757761593`*^9, 3.782651487100514*^9}, {
   3.782651522459735*^9, 3.78265152687016*^9}, {3.782651619397912*^9, 
   3.7826516353044767`*^9}, {3.782651687993082*^9, 3.782651690617908*^9}, {
   3.782651744170938*^9, 3.782651799845364*^9}, {3.7826518532091637`*^9, 
   3.782651860578827*^9}, {3.782651940959901*^9, 3.782651955003063*^9}, 
   3.782652042637216*^9, {3.782652093721058*^9, 3.782652137705906*^9}, {
   3.782652293765101*^9, 3.782652299091082*^9}, {3.782652435055934*^9, 
   3.7826525164747868`*^9}, {3.7826526391436167`*^9, 3.782652668033884*^9}, {
   3.782652894811685*^9, 3.782652894944569*^9}, {3.782652990238302*^9, 
   3.782653023076682*^9}, 3.782653081990574*^9, {3.7826531214204063`*^9, 
   3.782653125184949*^9}, {3.782653226922225*^9, 3.782653232066022*^9}, {
   3.782653329264668*^9, 3.782653371735875*^9}, {3.7826536230831957`*^9, 
   3.782653643311886*^9}, {3.782653710138713*^9, 3.78265372636576*^9}, {
   3.782653916734584*^9, 3.782654115654777*^9}, {3.782654163593597*^9, 
   3.782654165566875*^9}, {3.782654219754588*^9, 3.7826542353220882`*^9}, {
   3.782654282411169*^9, 3.7826542825514936`*^9}, {3.7826543139340553`*^9, 
   3.782654323680902*^9}, {3.782654401138813*^9, 3.7826544840046*^9}, {
   3.7826545238680553`*^9, 3.782654532030143*^9}, {3.782654586905161*^9, 
   3.782654645418839*^9}, {3.782654691727551*^9, 3.782654709860667*^9}, {
   3.782654753021707*^9, 3.7826547532394114`*^9}, {3.782654809286372*^9, 
   3.782654810210452*^9}, {3.782654852775363*^9, 3.782654853356887*^9}, {
   3.7826548861342697`*^9, 3.782654886403351*^9}, {3.7826549199002943`*^9, 
   3.7826549420376663`*^9}, {3.7826549836277246`*^9, 3.782654987891095*^9}, {
   3.782655026854473*^9, 3.782655027962081*^9}, {3.7826550734567947`*^9, 
   3.782655073981059*^9}, {3.782655422353335*^9, 3.782655422521903*^9}, {
   3.782655492460786*^9, 3.7826554929764338`*^9}, {3.782655601212327*^9, 
   3.782655602597061*^9}, {3.782655677537889*^9, 3.7826556780289288`*^9}, {
   3.782655711927175*^9, 3.782655721962577*^9}, {3.782655788645906*^9, 
   3.7826557958270407`*^9}, {3.78265593533495*^9, 3.7826559357922*^9}, 
   3.7827267979478617`*^9, {3.7827268285435457`*^9, 3.782726862390122*^9}, {
   3.782727635351644*^9, 3.782727723888867*^9}, {3.782727755221674*^9, 
   3.782727843094136*^9}, {3.782728081123386*^9, 3.782728171215087*^9}, {
   3.7827283253250103`*^9, 3.782728327152774*^9}, {3.7827291070133038`*^9, 
   3.7827291208464737`*^9}, {3.7827293315804453`*^9, 
   3.7827293320699863`*^9}, {3.7827293696904497`*^9, 
   3.7827293699603453`*^9}, {3.782729537223016*^9, 3.78272954087184*^9}, {
   3.78272994336827*^9, 3.7827299437973623`*^9}, {3.7827302974817867`*^9, 
   3.7827303128284492`*^9}, {3.782730403193295*^9, 3.782730448241214*^9}, {
   3.782730697290082*^9, 3.782730697432364*^9}, {3.78273105802437*^9, 
   3.78273112759741*^9}, {3.782731294887335*^9, 3.782731295171153*^9}, {
   3.782731475559413*^9, 3.78273147802925*^9}, {3.7827316417056704`*^9, 
   3.782731661199127*^9}, {3.782732087265669*^9, 3.782732297508623*^9}, {
   3.782732422182534*^9, 3.7827324741387568`*^9}, {3.782732561319419*^9, 
   3.782732568106201*^9}, {3.7827326266297407`*^9, 3.7827326587778597`*^9}, {
   3.782732748455347*^9, 3.782732748621538*^9}, {3.782732839964136*^9, 
   3.7827328456046124`*^9}, {3.782732922909382*^9, 3.782732937105996*^9}, {
   3.782733033899971*^9, 3.782733044838361*^9}, {3.782733095299*^9, 
   3.782733099926807*^9}, {3.782733141197282*^9, 3.7827331457158737`*^9}, {
   3.782733315885212*^9, 3.782733319549575*^9}, {3.78273335559588*^9, 
   3.782733360068643*^9}, {3.782733526195797*^9, 3.782733532785693*^9}, {
   3.782734000538859*^9, 3.782734070834807*^9}, {3.782734297396882*^9, 
   3.7827343280901623`*^9}, {3.782734379944693*^9, 3.7827344595500813`*^9}, {
   3.7827345877235823`*^9, 3.7827345879245987`*^9}, {3.7827346851296473`*^9, 
   3.782734736812943*^9}, {3.782734809605543*^9, 3.782734833479858*^9}, {
   3.782734901051442*^9, 3.782734926422406*^9}, {3.7827349852246437`*^9, 
   3.782735003921327*^9}, {3.7827350391603117`*^9, 3.782735040270121*^9}, {
   3.7827356645785933`*^9, 3.782735671871108*^9}, {3.782735702938797*^9, 
   3.782735703069523*^9}, {3.782735986495105*^9, 3.782735988557659*^9}, {
   3.782736197819861*^9, 3.782736201705883*^9}, {3.7827367739156103`*^9, 
   3.782736836167843*^9}, {3.7827372132437983`*^9, 3.782737213383079*^9}, {
   3.7827375821902847`*^9, 3.782737583627501*^9}, {3.782738036541898*^9, 
   3.782738036730855*^9}, {3.782738511831113*^9, 3.782738511978589*^9}, {
   3.7827388047470627`*^9, 3.782738855259901*^9}, {3.7827391987253733`*^9, 
   3.782739222950919*^9}, {3.7827392770791693`*^9, 3.78273927731318*^9}, {
   3.782739440739752*^9, 3.782739441061563*^9}, {3.7827401195857077`*^9, 
   3.782740230237424*^9}, {3.782740296458395*^9, 3.782740298620513*^9}, {
   3.782740370218642*^9, 3.7827404024599953`*^9}, {3.7827404380710907`*^9, 
   3.782740444624094*^9}, {3.782740480373495*^9, 3.782740481118219*^9}, {
   3.782740553186499*^9, 3.78274055976969*^9}, {3.7832527662586327`*^9, 
   3.78325299303976*^9}, {3.798359708292673*^9, 3.798359786127446*^9}, {
   3.798359820158654*^9, 3.7983599708397617`*^9}, {3.798360001630733*^9, 
   3.7983600544610777`*^9}}]
},
WindowSize->{1520, 951},
WindowMargins->{{23, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 35798, 728, 3099, "Input"]
}
]
*)

(* End of internal cache information *)
